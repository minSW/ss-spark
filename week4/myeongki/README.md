# 4주차 정리

## 10장

- 스파크에서 테이블을 생성하면 default 데이터 베이스에 등록된다.
- 테이블은 항상 데이터를 가지고 있다.(임시 테이블의 개념이 없다.)
- 테이블을 제거하면 모든 데이터가 제거되므로 조심해야 한다.
- 테이블 메타데이터를 유지하는 것은 가장 최신의 데이터셋을 읽고 있다는 것을 보장할 수 있는 중요한 작업 (REFRESH TABLE 구문은 테이블과 관련된 모든 캐싱된 항목을 갱신한다. 테이블이 이미 캐싱되어 있다면 다음번 스캔이 동작하는 시점에 다시 캐싱한다.)
- 테이블을 제거하면 테이블의 데이터가 모두 삭제되므로 매우 신중하게 작업하자!
- 기본적으로 뷰는 단순 쿼리 실행 계획일 뿐이다. 뷰를 사용하면 쿼리 로직을 체계화하거나 재사용하기 편하게 만들 수 있다.
- 세션이 종료되면 뷰도 사라진다.
- 사실 뷰는 기존 데이타 프레임에서 새로운 데이타 프레임을 만드는 것과 동일하다.
- 뷰는 어떤 데이터도 제거되지 않으며 뷰 정의만 제거된다는 점이 테이블 제거와 다르다.
- 데이터베이스는 여러 테이블을 조직화하기 위한 도구. 따로 정의하지 않으면 기본 데이터베이스 사용. 

## 11장

- 데이타셋은 자바 가상 머신을 사용하는 언어인 스칼라와 자바에서만 사용할 수 있다. 데이터셋을 사용해 데이터셋의 각 로우를 구성하는 객체를 정의한다.
- 도메인별 특정 객체를 효과적으로 지원하기 위해 인코더라 부르는 특수 개념이 필요하다. 인코더는 도메인별 특정 객체 t를 스파크 내부 데이터 타입으로 매핑하는 시스템을 의미한다.
- 데이타셋 api를 사용한다면 스파크는 데이터셋에 접근할 때마다 row 포맷이 아닌 사용자 정의 데이터 타입으로 변환하는데 이때 좀 느리지만 사용자에게 유연성을 제공할 수 있다. -> 파이썬으로 만든 사용자 정의 함수와 비슷한 상황으로 볼 수 있으나 사용자 정의 함수가 훨씬 더 느리다. -> 프로그래밍 언어를 전환하는 것이 사용자 정의 데이터 타입을 사용하는 것 보다 더 느리기 때문!
- 데이타셋을 사용하는 장점 중 하나는 로컬과 분산 환경의 워크로드에서 재사용할 수 있다는 점
- 일반 조인 역시 아주 잘 동작한다. 하지만 데이타 프레임을 반환하므로 jvm 데이터 타입 정보를 모두 잃게 된다. -> 데이타 셋 정의로 해당 문제를 해결할 수 있다.(joinWith를 이용하거나...)
- 사용자가 정의한 인코딩으로 세밀한 처리가 필요하거나 필요한 경우에만 데이타셋의 groupByKey를 사용해야 한다. 데이타셋은 빅데이터 처리 파이프라인의 처음과 끝 작업에서 주로 사용하게 될 것이다.